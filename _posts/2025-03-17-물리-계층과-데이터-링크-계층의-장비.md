---
title: 물리 계층과 데이터 링크 계층의 장비
date: 2025-03-18 21:46:21 +0900
categories: [Network]
tags: [Network]     # TAG 이름은 항상 소문자여야 합니다.
---

# 물리 계층과 데이터 링크 계층의 장비 🔌

## 계층별 역할 차이
- 물리 계층: 연결 & 신호 전달 (주소 개념 ❌)
  - 단순히 전기적 신호를 보내고 받는 역할만 수행
  - 송수신 정보에 대한 어떤 조작이나 판단도 하지 않음
- 데이터 링크 계층: 정확한 주소 기반 통신 (MAC 주소 ⭕)
  - MAC 주소를 사용하여 송수신지 특정 가능
  - 송수신 정보에 대한 조작 가능

## 대표적인 네트워크 장비
```
------------------------------------------------------------------------------------------------
|   계층            | 대표 장비           | 설명                                                    |
------------------------------------------------------------------------------------------------ 
| 물리 계층          | 허브, 리피터         | 1. 허브 : 여러 장치를 연결하는 장치 (수신된 정보를 모든 포트로 전송) |                        
|                  |                   | 2. 리피터 : 신호 증폭 장치                                  |
------------------------------------------------------------------------------------------------|
| 데이터 링크 계층     | 스위치              | MAC 주소를 기반으로 특정 포트에만 데이터를 전송하여 네트워크 효율성을  |
|                  |                   | 높이는 장치                                               |
------------------------------------------------------------------------------------------------

```

![네트워크 장비](/assets/img/물리 계층과 데이터 링크 계층의 장비.png)

## 허브의 특징
1. 받은 정보는 모든 포트로 내보낸다.
   - 정보에 대한 어떠한 조작도 판단도 하지 않는다. (물리 계층 장비이기 때문)
   - 전달받은 신호를 다른 모든 포트로 그대로 다시 내보낸다.
   - **데이터 링크 계층**에서 패킷의 MAC 주소를 확인하고 자신과 관련 없는 주소는 폐기 한다.

2. 반이중 통신
   - 반이중 모드 : 1차선 도로처럼 송수신을 번갈아 가면서 하는 통신 방식 (무전기 느낌)
   - 전이중 모드 : 송수신을 동시에 양방향으로 할 수 있는 통신 방식 (핸드폰으로 전화하는 느낌)

## 허브의 문제점과 해결 방법
1. 반이중 통신과 콜리전 도메인
   - 반이중 통신: 송신과 수신을 번갈아 가면서 하는 통신 방식 (무전기처럼)
   - 콜리전 도메인: 충돌이 발생할 수 있는 영역
     - 허브에 연결된 모든 호스트는 하나의 콜리전 도메인에 속함
     - 동시에 허브에 신호를 보내면 충돌 발생! 💥
     - ![허브 충돌](/assets/img/허브%20충돌.png)
  
2. 문제 해결 방법
   1. CSMA/CD (현재는 거의 사용 X)
      - 충돌을 감지하고 재전송하는 방식이지만, 근본적인 해결책은 아님 
      - 작동 원리
        1. 캐리어 감지: 통신 매체가 사용 중인지 확인
        ![alt text](/assets/img/CSMA_CD_1.png)
     
        2. 다중 접근: 여러 호스트가 동시에 네트워크에 접근 (충돌 가능성 ⬆️)
       ![alt text](/assets/img/CSMA_CD_2.png)

        3. 충돌 검출: 충돌 발생 시 전송 중단 후 잼 신호 전송 & 재전송
        ![alt text](/assets/img/CSMA_CD_3.png)

   2. 스위치 사용 (현재는 거의 사용 O)
      - 각 포트마다 독립적인 통신 채널을 제공하여 충돌 가능성을 최소화

## 스위치
허브의 충돌 문제는 CSMA/CD로 어느정도 완화할 수 있지만, 근본적인 해결 방법은 아니다.<br>
근본적인 해결 방법으로는 전달받은 신호를 수신지 호스트가 연결된 포트로만 내보내고, **전이중 모드**로 통신하면 된다.<br>
이를 위한 장비가 바로 **스위치**이다.
  - 허브와는 달리 특정 MAC 주소를 가진 호스트에만 프레임 전달 가능하다.
  - 전이중 모드 통신을 지원하기 때문에 CSMA/CD 프로토콜이 더 이상 필요하지 않다.

## 스위치의 주요 기능
1. 스위치의 MAC 주소 학습 기능
   - 전달받은 신호를 원하는 포트로만 내보낼 수 있다.
   - 포트별로 콜리전 도메인이 나누어지므로 충돌 위험이 감소한다.
2. 스위치의 VLAN 기능
   - 논리적으로 LAN을 분리하는 가상의 LAN, VLAN을 구성할 수 있다.

## 스위치의 MAC 주소 학습 기능
스위치의 MAC 주소 학습 기능에는 **플러딩, 포워딩과 필터링, 에이징**이라는 과정이 있다.
1. **프레임 수신**
   - 스위치는 네트워크에 연결된 장치로부터 프레임을 수신한다.
   - 프레임에는 출발지 MAC 주소(Source MAC Address, SMA)와 목적지 MAC 주소(Destination MAC Address, DMA)가 포함되어 있다.
2. **MAC 주소 학습**
   - 스위치는 수신된 출발지 MAC 주소(SMA)를 확인한다.
   - **[플러딩 준비 단계]** 스위치가 자신의 MAC 주소 테이블에 출발지 MAC 주소가 있는지 확인한다.
     - **테이블에 출발지 MAC 주소가 없는 경우 :**
       - 스위치는 출발지 MAC 주소와 해당 프레임이 수신된 포트 번호를 MAC 주소 테이블에 기록한다.(MAC 주소 학습)
       - 이제 스위치는 해당 MAC 주소를 가진 장치가 어느 포트에 연결되어 있는지 알게 된다.
     - **테이블에 출발지 MAC 주소가 있는 경우 :**
       - 이미 학습된 MAC 주소이므로, 학습 과정 생략
3. **목적지 MAC 주소 확인** 
   - 스위치는 수신된 프레임의 목적지 MAC 주소를 확인한다.
4. **프레임 전달**
   - **[플러딩]** 스위치는 MAC 주소 테이블에서 목적지 MAC 주소를 찾는다.
     - **테이블에 목적지 MAC 주소가 없는 경우 (목적지를 모르는 경우) :** 
       - 스위치는 수신된 프레임을 해당 VLAN에 속한 모든 포트로 전달한다. 이 과정을 **플러딩**이라고 한다.
       - 플러딩은 네트워크 초기 단계에서 MAC 주소 정보를 학습하고, 목적지를 알 수 없는 트래픽을 처리하는데 사용된다.
     - **테이블에 목적지 MAC 주소가 있는 경우 (목적지를 아는 경우)**
       - **[포워딩]** 스위치는 MAC 주소 테이블에서 목적지 MAC 주소에 해당하는 포트 번호를 찾는다.
       - 스위치는 수신된 프레임을 해당 포트로만 전달한다. 이 과정을 **포워딩**이라고 한다.
         - 포워딩은 스위치의 핵심 기능이며, 네트워크 트래픽을 효율적으로 관리하고 불필요한 트래픽을 줄이는데 사용된다.
       - [필터링] 스위치는 수신된 프레임의 출발지 MAC 주소와 목적지 MAC 주소가 동일한 포트에 연결된 경우, 해당 프레임을 전달하지 않고 폐기한다. 이 과정을 
       **필터링**이라고 한다.
5. 에이징
   - 스위치는 MAC 주소 테이블에 저장된 MAC 주소 정보의 유효 시간을 주기적으로 확인한다.
   - 일정 시간 동안 사용되지 않은 MAC 주소 정보는 테이블에서 삭제한다. 이 과정을 **에이징**이라고 한다.
   - 에이징은 MAC 주소 테이블의 크기를 유지하고, 잘못된 MAC 주소 정보로 인한 통신 오류를 방지하는데 사용된다.

## 스위치의 MAC 주소 학습 기능 그림으로 다시 보기 🎨
- **호스트 A가 호스트 C로 프레임을 전송하는 상황을 가정**
  - 호스트 A는 1번 포트로 프레임을 전송해야하고, 스위치는 전달받은 프레임을 3번 포트로 내보내야된다.
![호스트A가 C로 프레임 전송](/assets/img/호스트A가%20호스트C로%20프레임%20전송.png)

- **만약 스위치가 MAC 주소를 학습하기 이전이라면?**
  - 스위치는 호스트 A,B,C,D의 MAC 주소와 연결된 포트의 연관 관계를 모름
![MAC 주소 학습 전](/assets/img/MAC%20주소%20학습전.png)

- **스위치가 호스트 A로 부터 프레임을 받았다면?**
  - 프레임 내 송신지 **MAC 주소** 를 바탕으로 MAC 주소 테이블에 기록
  - 하지만 여전히 수신지 호스트 C가 연결된 포트는 모름
  ![프레임 받은 후 MAC 주소 테이블에 기록](/assets/img/프레임%20받은%20후.png)

- **호스트C의 포트를 찾기 위해 플러딩 실행**
  - 플러딩(flooding) : 허브처럼 모든 포트로 프레임 전송
  - 호스트 B,C,D 프레임 수신 -> 호스트 B와 D는 프레임 폐기
  ![플러딩](/assets/img/플러딩.png)

- **호스트C는 스위치로 응답 프레임 전송**
  - 호스트 C는 송신지 MAC 주소가 본인의 MAC 주소임을 확인했고, MAC 주소 테이블에 해당 포트의 MAC 주소 저장
  - 이제 호스트 A와 C가 프레임을 주고 받을 떄는 다른 포트로 프레임을 보낼 필요 없음
  ![플러딩2](/assets/img/플러딩2.png)

- **필터링(filtering)과 포워딩(forwarding)**
  - 호스트 A가 호스트 C에게 프레임을 전송하면
  - 스위치는 호스트 B,D가 연결된 포트로는 내보내지 않도록 **필터링(filtering)**
  - 호스트 C가 연결된 포트로 프레임을 **포워딩(forwarding)**
  ![필터링과 포워딩](/assets/img/필터링과%20포워딩.png)

- **에이징(aging)**
  - 만약 MAC 주소 테이블에 등록된 포트에서 일정 시간 동안 프레임을 받지 못하면 해당 항목은 삭제
  - 일정 시간 동안 송신지 MAC 주소가 `ab:cd:ab:cd:11:22`인 프레임을 1번 포트에서 못 받으면 이 항목은 삭제

## 스위치의 VLAN 기능
VLAN(Virtual LAN)은 물리적으로 분리되어 있지 않은 **네트워크를 논리적으로 분할하여 마치 별개의 네트워크처럼** 사용할 수 있도록 하는 기술이다.<br>
스위치에서 VLAN을 사용하면 네트워크 관리자는 물리적 제약없이 유연하게 네트워크를 구성하고 관리할 수 있다.

### VLAN의 기본 개념
1. **브로드캐스트 도메인 분리**
   - VLAN은 브로드캐스트 트래픽이 특정 VLAN 내에서만 전달되도록 제한한다. 즉, **서로 다른 VLAN에 속한 장치들은 직접적으로 브로드캐스트 통신을 할 수 없다.** 이는 네트워크 혼잡을 줄이고 보안을 강화해준다.
2. **논리적 네트워크 분할**
   - VLAN은 물리적 연결 방식과 상관없이 논리적으로 네트워크를 분할한다. 예를 들어, **같은 스위치에 연결된 장치라도 서로 다른 VLAN에 속하도록 설정하면, 다른 스위치에 연결된 것 처럼 동작한다.**
3. **VLAN ID**
   - **각 VLAN은 고유한 VLAN ID를 가지며, 이 ID는 트래픽이 어느 VLAN에 속하는지를 식별하는데 사용된다.** VLAN ID는 1부터 4094까지의 숫자로 구성된다.

### VLAN 동작 방식
1. VLAN 설정
   - **스위치에서 각 포트를 특정 VLAN에 할당**한다. 예를 들어, 1번 포트를 VLAN 10에, 2번 포트를 VLAN 20에 할당할 수 있다.
2. 프레임 태깅
   - VLAN을 지원하는 스위치는 **프레임에 VLAN_ID를 나타내는 태그를 추가**한다. 해당 태그는 프레임의 헤더에 삽입된다.
3. 프레임 전달
   - 스위치는 수신된 프레임의 VLAN ID를 확인하고, **동일한 VLAN ID를 가진 포트로만 프레임을 전달**한다.
   - VLAN 10에 속한 포트에서 수신된 프레임은 VLAN 10에 속한 다른 포트로만 전달된다.

### VLAN의 장점
1. 보안 강화
   - 서로 다른 VLAN에 속한 장치들은 직접적으로 통신할 수 없으므로, 네트워크 보안을 강화할 수 있다.
   - 예를 들어, 게스트 네트워크를 별도의 VLAN으로 분리하여 내부 네트워크에 대한 접근을 제한할 수 있다.
2. 네트워크 성능 향상
   - 브로드캐스트 트래픽 범위를 줄이고 네트워크 혼잡을 완화하고, 전체적인 네트워크 성능을 향상시킬 수 있다.
3. 유연한 네트워크 구성
   - 물리적인 제약 없이 논리적으로 네트워크를 분할하고 재구성할 수 있어, 변화하는 네트워크 요구 사항에 유연하게 대응할 수 있다.
4. 관리 효율성 증가
   - VLAN을 사용하여 네트워크를 기능별 또는 부서별 등으로 논리적으로 분리하여 관리할 수 있으므로, 네트워크 관리 효율성이 증가한다.
5. 비용 절감
   - 물리적인 네트워크를 추가하지 않고도 네트워크를 분할할 수 있으므로, 새로운 장비를 사지 않아도 된다.


